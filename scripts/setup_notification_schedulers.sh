#!/bin/bash

# =====================================================
# GUIA PARA CONFIGURAR SCHEDULERS DE NOTIFICAÃ‡Ã•ES
# Ray Club - Sistema de NotificaÃ§Ãµes AutomÃ¡ticas
# =====================================================

echo "ğŸš€ Guia para configurar schedulers de notificaÃ§Ãµes para Ray Club..."
echo ""
echo "âš ï¸  IMPORTANTE: Os schedulers (cron jobs) devem ser configurados atravÃ©s do Supabase Dashboard"
echo "   pois a versÃ£o atual do CLI nÃ£o suporta o comando 'schedule'."
echo ""
echo "ğŸ“‹ PASSOS PARA CONFIGURAR NO DASHBOARD:"
echo ""
echo "1. ğŸŒ Acesse: https://supabase.com/dashboard/project/zsbbgchsjiuicwvtrldn"
echo ""
echo "2. ğŸ”— Conecte o projeto ao GitHub:"
echo "   â€¢ VÃ¡ em Settings > Integrations"
echo "   â€¢ Clique em 'Connect to GitHub'"
echo "   â€¢ Selecione o repositÃ³rio 'rayclubfunctions'"
echo "   â€¢ Confirme a conexÃ£o"
echo ""
echo "3. â° Ative o menu Scheduler:"
echo "   â€¢ ApÃ³s conectar ao GitHub, o menu 'Scheduler' aparecerÃ¡ na barra lateral"
echo "   â€¢ Clique em 'Scheduler' no menu lateral"
echo ""
echo "4. â• Criar os schedulers manualmente:"
echo ""
echo "   ğŸ“… SCHEDULER 1 - NotificaÃ§Ãµes da ManhÃ£:"
echo "   â€¢ Nome: notificacoes_manha"
echo "   â€¢ FunÃ§Ã£o: send_push_notifications"
echo "   â€¢ Cron: 0 8 * * * (todo dia Ã s 8h)"
echo "   â€¢ DescriÃ§Ã£o: NotificaÃ§Ãµes motivacionais e receitas matinais"
echo ""
echo "   ğŸ“… SCHEDULER 2 - NotificaÃ§Ãµes da Tarde:"
echo "   â€¢ Nome: notificacoes_tarde"
echo "   â€¢ FunÃ§Ã£o: send_push_notifications"
echo "   â€¢ Cron: 0 15 * * * (todo dia Ã s 15h)"
echo "   â€¢ DescriÃ§Ã£o: Lembretes de treino e lanches saudÃ¡veis"
echo ""
echo "   ğŸ“… SCHEDULER 3 - NotificaÃ§Ãµes da Noite:"
echo "   â€¢ Nome: notificacoes_noite"
echo "   â€¢ FunÃ§Ã£o: send_push_notifications"
echo "   â€¢ Cron: 0 20 * * * (todo dia Ã s 20h)"
echo "   â€¢ DescriÃ§Ã£o: ReflexÃµes e receitas de jantar"
echo ""
echo "5. ğŸ” Configurar variÃ¡veis de ambiente:"
echo "   â€¢ VÃ¡ em Settings > Edge Functions"
echo "   â€¢ Adicione as seguintes variÃ¡veis:"
echo "     - SUPABASE_URL: https://zsbbgchsjiuicwvtrldn.supabase.co"
echo "     - SUPABASE_SERVICE_ROLE_KEY: [sua service role key]"
echo "     - FCM_SERVER_KEY: [sua FCM server key do Firebase]"
echo ""
echo "6. âœ… Testar a funÃ§Ã£o:"
echo "   â€¢ No Dashboard, vÃ¡ em Edge Functions"
echo "   â€¢ Clique em 'send_push_notifications'"
echo "   â€¢ Use o botÃ£o 'Invoke' para testar manualmente"
echo ""
echo "ğŸ“š FORMATO CRON EXPLICADO:"
echo "   Formato: minuto hora dia mÃªs dia_da_semana"
echo "   â€¢ 0 8 * * * = todo dia Ã s 8:00"
echo "   â€¢ 0 15 * * * = todo dia Ã s 15:00"
echo "   â€¢ 0 20 * * * = todo dia Ã s 20:00"
echo "   â€¢ 0 */4 * * * = a cada 4 horas"
echo "   â€¢ 0 9 * * 1-5 = segunda a sexta Ã s 9h"
echo ""
echo "ğŸ”§ VERIFICAÃ‡ÃƒO:"
echo "   ApÃ³s configurar, vocÃª pode verificar os schedulers ativos no Dashboard"
echo "   em Scheduler > View all schedules"
echo ""
echo "ğŸ¯ STATUS ATUAL:"
echo "   âœ… FunÃ§Ã£o 'send_push_notifications' deployada com sucesso"
echo "   âœ… CÃ³digo da funÃ§Ã£o estÃ¡ funcionando"
echo "   â³ Schedulers precisam ser configurados manualmente no Dashboard"
echo ""
echo "ğŸš€ PRÃ“XIMOS PASSOS:"
echo "   1. Acesse o Dashboard do Supabase"
echo "   2. Conecte ao GitHub (se ainda nÃ£o conectou)"
echo "   3. Configure os 3 schedulers conforme instruÃ§Ãµes acima"
echo "   4. Adicione as variÃ¡veis de ambiente"
echo "   5. Teste a funÃ§Ã£o manualmente"
echo ""
